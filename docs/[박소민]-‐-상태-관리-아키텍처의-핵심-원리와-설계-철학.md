# ğŸ§ [Deep Dive] ìƒíƒœ ê´€ë¦¬ ì•„í‚¤í…ì²˜ì˜ í•µì‹¬ ì›ë¦¬ì™€ ì„¤ê³„ ì² í•™

## 1. Flux ì•„í‚¤í…ì²˜ëŠ” ì™œ 'ë‹¨ë°©í–¥'ì¸ê°€? (Dispatcherì˜ ì—­í• )

### ğŸ’¡ í•µì‹¬ ì›ë¦¬
**"ë°ì´í„° íë¦„ì˜ ì˜ˆì¸¡ ê°€ëŠ¥ì„±(Predictability)ì„ ë³´ì¥í•˜ê¸° ìœ„í•¨"**

ê³¼ê±° MVC íŒ¨í„´ì˜ ì–‘ë°©í–¥ ë°ì´í„° íë¦„ì€ í•œ ëª¨ë¸ì˜ ë³€ê²½ì´ ë‹¤ë¥¸ ë·°ë¥¼ ë°”ê¾¸ê³ , ë‹¤ì‹œ ëª¨ë¸ì„ ë°”ê¾¸ëŠ” **'í­í¬ìˆ˜ ì—…ë°ì´íŠ¸(Cascading Updates)'**ë¥¼ ì¼ìœ¼ì¼œ ë²„ê·¸ ì¶”ì ì„ ì–´ë µê²Œ í–ˆìŠµë‹ˆë‹¤.

### ğŸ” ìƒì„¸ ë©”ì»¤ë‹ˆì¦˜
* **Dispatcher (êµí†µ ê²½ì°°)**:
    * ëª¨ë“  ë°ì´í„° ë³€ê²½ ìš”ì²­(Action)ì€ ì¤‘ì•™ í—ˆë¸Œì¸ Dispatcherë¥¼ í†µê³¼í•´ì•¼ í•©ë‹ˆë‹¤.
    * **ë™ê¸°ì  ì²˜ë¦¬**: DispatcherëŠ” í•œ ë²ˆì— í•˜ë‚˜ì˜ Actionë§Œ ì²˜ë¦¬í•˜ë©°, Storeê°€ ì—…ë°ì´íŠ¸ë˜ëŠ” ë„ì¤‘ ë‹¤ë¥¸ Actionì´ ë“¤ì–´ì˜¤ë©´ ì´ë¥¼ ëŒ€ê¸°ì‹œí‚¤ê±°ë‚˜ ì°¨ë‹¨í•˜ì—¬ ë°ì´í„° ì¶©ëŒì„ ì›ì²œ ë´‰ì‡„í•©ë‹ˆë‹¤.

### ğŸ“š ê³µì‹ ê·¼ê±° (References)
* **[Flux (Archived) - Overview]**: "The dispatcher disallows cascading updates..." (DispatcherëŠ” í­í¬ìˆ˜ ì—…ë°ì´íŠ¸ë¥¼ í—ˆìš©í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.)
    * ğŸ”— [https://facebookarchive.github.io/flux/docs/in-depth-overview/](https://facebookarchive.github.io/flux/docs/in-depth-overview/)
* **[Redux - Motivation]**: "Predictable state container..." (ì˜ˆì¸¡ ê°€ëŠ¥í•œ ìƒíƒœ ì»¨í…Œì´ë„ˆ)
    * ğŸ”— [https://redux.js.org/understanding/thinking-in-redux/motivation](https://redux.js.org/understanding/thinking-in-redux/motivation)

## 2. Atomic íŒ¨í„´: ì›ìì˜ ê²°í•©(Composition)ì´ë€?

### ğŸ’¡ í•µì‹¬ ì›ë¦¬
**"ì‘ì€ ìƒíƒœ(Atom)ë¥¼ ì…ë ¥ê°’ìœ¼ë¡œ ë°›ì•„ ìƒˆë¡œìš´ ë°ì´í„°(Selector)ë¥¼ ê³„ì‚°(íŒŒìƒ)í•´ë‚¸ë‹¤"**

ìƒíƒœë¥¼ ê±°ëŒ€í•œ íŠ¸ë¦¬ê°€ ì•„ë‹Œ **ê·¸ë˜í”„(Graph)** í˜•íƒœë¡œ ê´€ë¦¬í•©ë‹ˆë‹¤. ì´ë¥¼ í†µí•´ ìƒíƒœì˜ ì˜ì¡´ì„±ì„ ì •ì˜í•˜ê³ , ê´€ë ¨ëœ ë°ì´í„°ë§Œ íš¨ìœ¨ì ìœ¼ë¡œ ì—…ë°ì´íŠ¸í•©ë‹ˆë‹¤.

### ğŸ” ìƒì„¸ ë©”ì»¤ë‹ˆì¦˜
* **íŒŒìƒ ìƒíƒœ (Derived State)**:
    * `Atom A` + `Atom B` â†’ `Selector C`
    * Aë‚˜ Bê°€ ë³€í•˜ë©´, CëŠ” ì´ë¥¼ ê°ì§€í•˜ê³  **ìë™ìœ¼ë¡œ ì¬ê³„ì‚°**ë©ë‹ˆë‹¤. ì´ëŠ” í•¨ìˆ˜í˜• í”„ë¡œê·¸ë˜ë°ì˜ ìˆœìˆ˜ í•¨ìˆ˜ ê°œë…ê³¼ ì¼ì¹˜í•©ë‹ˆë‹¤.

### ğŸ“š ê³µì‹ ê·¼ê±° (References)
* **[Recoil - Core Concepts]**: "Selectors are pure functions that accept atoms... derived state..." (SelectorëŠ” Atomì„ ë°›ì•„ íŒŒìƒ ìƒíƒœë¥¼ ê³„ì‚°í•˜ëŠ” ìˆœìˆ˜ í•¨ìˆ˜ì…ë‹ˆë‹¤.)
    * ğŸ”— [https://recoiljs.org/docs/introduction/core-concepts#selectors](https://recoiljs.org/docs/introduction/core-concepts#selectors)
* **[Jotai - Derived Atoms]**: "You can combine atoms to build derived atoms." (Atomë“¤ì„ ì¡°í•©í•˜ì—¬ íŒŒìƒëœ Atomì„ ë§Œë“¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.)
    * ğŸ”— [https://jotai.org/docs/core/atom#derived-atoms](https://jotai.org/docs/core/atom#derived-atoms)

## 3. ZustandëŠ” ì–´ë–»ê²Œ Fluxë¥¼ ê°„ì†Œí™”í–ˆëŠ”ê°€?

### ğŸ’¡ í•µì‹¬ ì›ë¦¬
**"Fluxì˜ ì² í•™ì€ ìœ ì§€í•˜ë˜, í´ë¡œì €(Closure)ì™€ Observer íŒ¨í„´ìœ¼ë¡œ êµ¬í˜„ ë³µì¡ë„ë¥¼ ì œê±°í•¨"**

Reduxì˜ ë³µì¡í•œ ë³´ì¼ëŸ¬í”Œë ˆì´íŠ¸(Action Creator, Type definition, Reducer switchë¬¸)ë¥¼ ì œê±°í•˜ê³  ì‹¤ìš©ì£¼ì˜ë¥¼ íƒí–ˆìŠµë‹ˆë‹¤.

### ğŸ” ìƒì„¸ ë©”ì»¤ë‹ˆì¦˜ (Observer Pattern)
1.  **Store ìƒì„± (Closure)**: `create` í•¨ìˆ˜ê°€ í˜¸ì¶œë˜ë©´ ìŠ¤í† ì–´ ìƒíƒœì™€ ë¦¬ìŠ¤ë„ˆ ì§‘í•©ì„ í´ë¡œì € ë²”ìœ„ì— ê°€ë‘¡ë‹ˆë‹¤.
2.  **ì¦‰ê°ì ì¸ ì „íŒŒ**: ìƒíƒœë¥¼ ë³€ê²½í•˜ëŠ” `set` í•¨ìˆ˜ê°€ í˜¸ì¶œë˜ë©´, ìƒíƒœë¥¼ ë°”ê¾¼ ì§í›„ **ì¦‰ì‹œ** ëª¨ë“  `listener`ì—ê²Œ ì•Œë¦¼ì„ ë³´ëƒ…ë‹ˆë‹¤.
3.  ì´ ê³¼ì •ì´ í›…(Hook) ë‚´ë¶€ì— ìº¡ìŠí™”ë˜ì–´ ìˆì–´, ì‚¬ìš©ìëŠ” ë³µì¡í•œ Dispatch ê³¼ì • ì—†ì´ í•¨ìˆ˜ í˜¸ì¶œë§Œìœ¼ë¡œ ìƒíƒœë¥¼ ê´€ë¦¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### ğŸ“š ê³µì‹ ê·¼ê±° ë° ì†ŒìŠ¤ ì½”ë“œ
* **[Zustand - Introduction]**: "A small, fast and scalable bearbones state-management solution using simplified flux principles." (ê°„ì†Œí™”ëœ Flux ì›ì¹™ì„ ì‚¬ìš©í•˜ëŠ” ìµœì†Œí•œì˜ ì†”ë£¨ì…˜)
    * ğŸ”— [https://github.com/pmndrs/zustand#readme](https://github.com/pmndrs/zustand#readme)
* **[Zustand Source Code (vanilla.ts)]**:
    * *ê²€ì¦ í¬ì¸íŠ¸*: ì†ŒìŠ¤ ì½”ë“œ ë‚´ `listeners` ê´€ë¦¬ì™€ `setState` í˜¸ì¶œ ì‹œ ë£¨í”„ë¥¼ ëŒë©° ì•Œë¦¼ì„ ë³´ë‚´ëŠ” ë¡œì§ í™•ì¸.
    * ğŸ”— [https://github.com/pmndrs/zustand/blob/main/src/vanilla.ts](https://github.com/pmndrs/zustand/blob/main/src/vanilla.ts)

---

## ğŸ§ Deep Dive 2: í•µì‹¬ ê°œë… ìƒì„¸ ë¶„ì„

### 1. Atomic íŒ¨í„´ê³¼ ìˆœìˆ˜ í•¨ìˆ˜(Pure Function)ì˜ ê´€ê³„

Atomic íŒ¨í„´(Recoil, Jotai)ì˜ `Selector`ëŠ” í•¨ìˆ˜í˜• í”„ë¡œê·¸ë˜ë°ì˜ **ìˆœìˆ˜ í•¨ìˆ˜** ê°œë…ì„ ê·¸ëŒ€ë¡œ ì°¨ìš©í–ˆìŠµë‹ˆë‹¤.

* **ìˆœìˆ˜ í•¨ìˆ˜ì˜ ì •ì˜**: ë™ì¼í•œ ì¸ì(Input)ê°€ ë“¤ì–´ì˜¤ë©´ ì–¸ì œë‚˜ ë™ì¼í•œ ê²°ê³¼(Output)ë¥¼ ë°˜í™˜í•˜ë©°, ì™¸ë¶€ ìƒíƒœë¥¼ ë³€ê²½í•˜ì§€ ì•ŠëŠ”(No Side-effect) í•¨ìˆ˜.
* **ì ìš© ì›ë¦¬**:
    * `Selector C = f(Atom A, Atom B)`
    * `Atom A`ì™€ `Atom B`ì˜ ê°’ì´ ë³€í•˜ì§€ ì•Šì•˜ë‹¤ë©´, `Selector C`ì˜ ì¬ê³„ì‚° ë¡œì§ì„ ì‹¤í–‰í•˜ì§€ ì•Šê³  **ë©”ëª¨ë¦¬ì— ì €ì¥ëœ ì´ì „ ê²°ê³¼ê°’(Cache)**ì„ ì¦‰ì‹œ ë°˜í™˜í•©ë‹ˆë‹¤.
    * ì´ê²ƒì´ Recoil/Jotaiê°€ ë³µì¡í•œ ì—°ì‚°ì—ì„œë„ ë†’ì€ ì„±ëŠ¥ì„ ìœ ì§€í•˜ëŠ” ë¹„ê²°ì…ë‹ˆë‹¤.

> **ì°¸ê³ **: Reactì˜ `useMemo`ë„ ì •í™•íˆ ì´ ìˆœìˆ˜ í•¨ìˆ˜ì˜ ì›ë¦¬ë¥¼ ì´ìš©í•œ ìµœì í™” ê¸°ë²•ì…ë‹ˆë‹¤.

### 2. Zustandì˜ ë‚´ë¶€ êµ¬í˜„: Closure & Observer Pattern

ZustandëŠ” Reactì˜ ë§ˆë²•ì´ ì•„ë‹Œ, ìë°”ìŠ¤í¬ë¦½íŠ¸ì˜ ê¸°ë³¸ ê¸°ëŠ¥ì¸ **í´ë¡œì €(Closure)**ì™€ **Observer íŒ¨í„´**ì„ ê²°í•©í•˜ì—¬ êµ¬í˜„ë˜ì—ˆìŠµë‹ˆë‹¤.

#### A. í´ë¡œì € (The State Container)
`create` í•¨ìˆ˜ê°€ í˜¸ì¶œë˜ëŠ” ìˆœê°„, `state` ë³€ìˆ˜ì™€ `listeners` Setì€ í•¨ìˆ˜ ìŠ¤ì½”í”„ ë‚´ë¶€ì— ìƒì„±ë˜ì–´ ì™¸ë¶€ì—ì„œ ì§ì ‘ ì ‘ê·¼í•  ìˆ˜ ì—†ëŠ” **ë¹„ê³µê°œ ì €ì¥ì†Œ(Private Scope)**ì— ì €ì¥ë©ë‹ˆë‹¤. í•¨ìˆ˜ ì‹¤í–‰ì´ ëë‚˜ë„ ì´ ë³€ìˆ˜ë“¤ì€ ë©”ëª¨ë¦¬ì— ë‚¨ì•„ ë°ì´í„°ì˜ ì˜ì†ì„±ì„ ë³´ì¥í•©ë‹ˆë‹¤.

#### B. Observer íŒ¨í„´ (The Subscription System)
ZustandëŠ” ë°ì´í„°ì˜ ë³€ê²½ì„ ê°ì§€í•˜ê³  ì „íŒŒí•˜ê¸° ìœ„í•´ **ë°œí–‰/êµ¬ë…(Pub/Sub)** ëª¨ë¸ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.
1.  **êµ¬ë…(Subscribe)**: ì»´í¬ë„ŒíŠ¸ëŠ” ë§ˆìš´íŠ¸ ì‹œ `subscribe` í•¨ìˆ˜ë¥¼ í†µí•´ ìì‹ ì„ `listeners` ëª…ë‹¨ì— ë“±ë¡í•©ë‹ˆë‹¤.
2.  **ë°œí–‰(Publish)**: ìƒíƒœê°€ ë³€ê²½(`set`)ë˜ë©´, ZustandëŠ” ì¦‰ì‹œ `listeners`ë¥¼ ìˆœíšŒí•˜ë©° ë“±ë¡ëœ ëª¨ë“  í•¨ìˆ˜ë¥¼ ì‹¤í–‰í•©ë‹ˆë‹¤.

#### ğŸ” ì†ŒìŠ¤ ì½”ë“œë¡œ ê²€ì¦í•˜ê¸°
ì‹¤ì œ Zustandì˜ ì½”ì–´ ë¡œì§(`vanilla.ts`)ì€ ì•½ 30~40ì¤„ì˜ ì½”ë“œë¡œ ì´ ê°œë…ì„ êµ¬í˜„í•˜ê³  ìˆìŠµë‹ˆë‹¤.

* **[GitHub] Zustand Source Code (vanilla.ts)**
    * *í™•ì¸ í¬ì¸íŠ¸*: `createStore` í•¨ìˆ˜ ë‚´ë¶€ì˜ `let state` ì„ ì–¸(í´ë¡œì €)ê³¼ `listeners.forEach` í˜¸ì¶œ(Observer) ë¶€ë¶„.
    * ğŸ”— [https://github.com/pmndrs/zustand/blob/main/src/vanilla.ts](https://github.com/pmndrs/zustand/blob/main/src/vanilla.ts)

* **[MDN] Closures (í´ë¡œì € ê°œë…)**
    * ğŸ”— [https://developer.mozilla.org/ko/docs/Web/JavaScript/Closures](https://developer.mozilla.org/ko/docs/Web/JavaScript/Closures)
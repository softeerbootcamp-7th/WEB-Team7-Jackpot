# 🤔 [고민한 주제] 드롭다운 키보드 탐색(A11y) 기능 추가 및 구조/성능 최적화
관련 [커밋](https://github.com/softeerbootcamp-7th/WEB-Team7-Jackpot/pull/498/changes/1490d8607bce482305fe39eeb76f80c26762ec25#diff-62310fe0b79c9d3a76721a9a066cc7130a12884969ca6e0f7d3e7ad4999aa0de)입니다.

## 📝 고민 배경
- **왜 이 고민을 하게 되었는가?**: 사용성 개선을 위해 드롭다운에 키보드 조작(방향키 이동, Enter 선택) 및 자동 스크롤 동기화 기능을 추가해야 함. 이 과정에서 각 컴포넌트마다 중복 코드가 발생할 우려가 있었고, 상태 초기화 시 불필요한 렌더링이 발생하는 안티 패턴(Double Render)을 마주함.
- **전제 조건**: React, TypeScript, Tailwind CSS, Layered 아키텍처 환경.
- **제약 사항**: 프로젝트 마감까지 단 **2일** 남음. 대규모 리팩토링이나 구조 변경은 위험하며, 기존 코드를 최대한 유지하면서 안정성과 재사용성을 챙겨야 함.

## 🔄 고려한 선택지

### 선택지 1: 각 컴포넌트 내부에 로직 하드코딩 (As-Is)
- **개념**: `RecruitPeriodSelectInput`이나 `LabeledSelectInput` 내부에 직접 `useState`와 키보드 이벤트 핸들러를 모두 작성하는 방식.
- **장점**: 당장 눈앞의 컴포넌트 하나를 수정하기엔 가장 빠름.
- **단점**: 드롭다운이 추가될 때마다 똑같은 로직(방향키 이동, 스크롤 계산 등)을 복사&붙여넣기 해야 함. 유지보수 최악.

### 선택지 2: Wrapper 컴포넌트로 추상화 (`<Dropdown>`)
- **개념**: UI와 로직을 모두 감싸는 부모 UI 컴포넌트를 만드는 방식.
- **장점**: 컴포넌트 트리가 직관적이며 HTML 구조를 강제할 수 있음.
- **단점**: Trigger 요소가 `<button>`일 때와 `<input>`일 때 모양과 동작이 다른데, 이를 모두 수용하려면 Props가 기하급수적으로 늘어나 컴포넌트가 무거워짐 (UI 파편화 방어 실패).

### 선택지 3: Custom Hook으로 로직만 분리 (Headless 패턴)
- **개념**: 시각적인 UI 요소는 각 컴포넌트가 알아서 그리고, 키보드 이동, 스크롤 동기화 같은 '동작(Behavior)'만 `useDropdownKeyboard` 훅으로 빼내는 방식.
- **장점**: 껍데기(UI)가 Input이든 Button이든 상관없이 로직을 완벽하게 재사용 가능. 관심사 분리로 가독성이 극대화됨.
- **단점**: 사용할 때마다 `ref`와 이벤트 핸들러(`onKeyDown` 등)를 요소에 수동으로 연결해줘야 하는 약간의 보일러플레이트 코드가 발생함.

## ⚖️ 비교 정리

| 항목 | 선택지 1 (하드코딩) | 선택지 2 (Wrapper UI) | 선택지 3 (Custom Hook) |
|------|----------|----------|----------|
| **구현 난이도** | 하 (당장 짜기 쉬움) | 중 (Props 설계 까다로움) | 중상 (Hook 설계 이해 필요) |
| **유지보수성** | 최하 (수정 시 전부 찾아야 함) | 중 (로직은 모이나 UI 조건문 폭발) | 최상 (로직 한 곳에서 완벽 제어) |
| **확장성/성능** | 최하 | 중하 (무거운 렌더링) | 최상 (가볍고 유연함) |

## ✅ 최종 선택
- **선택한 방안**: **선택지 3 (Custom Hook - Headless 패턴)** + `useEffect` 대신 **렌더링 중 상태 업데이트(Derived State)** 방식 적용.
- **선택 이유**: 마감이 2일 남은 상황에서 가장 안전하면서도 확실하게 코드 중복을 제거할 수 있는 방법. UI를 건드리지 않으므로 예기치 않은 디자인 깨짐을 방지할 수 있음. 또한, `useEffect`로 인한 불필요한 이중 렌더링(안티 패턴)을 렌더링 중 업데이트 로직으로 고쳐 성능을 최적화함.

## 📉 아쉬운 점
- **포기한 부분**: 촉박한 일정 탓에 완벽한 스크린 리더 호환성을 위한 WAI-ARIA 속성(`aria-activedescendant`, `aria-expanded` 등)까지 세밀하게 챙기지는 못함.
- **리스크**: Hook 사용 시 `itemCount`에 원본 데이터가 아닌 필터링된 데이터(`searchData`)의 길이를 넣어야 한다는 점을 개발자가 주의해야 함 (휴먼 에러 가능성).

## 🔮 이후 개선 방향
- **추후 다시 고려할 사항**: 
  1. 훅에서 단순히 상태만 반환하는 것이 아니라, HTML에 바로 전개(spread)할 수 있는 A11y(접근성) 속성 객체까지 반환하도록 고도화.
  2. 제네릭(`T`)을 Hook 내부까지 확장하여 완벽한 타입 추론 보장.
# 📖 URL 기반 계층적 상태 관리 및 히스토리 설계

## ✨ 한 줄 요약
> 사용자 작업 맥락(Context)을 URL 파라미터와 동기화하여, '뒤로 가기'나 '새로고침' 시에도 중첩된 UI 상태와 데이터 페칭을 완벽하게 보존하는 라우팅 시스템입니다.

---

## 🎯 등장 배경
- **해결하고자 하는 문제**: 복잡한 중첩 구조(탭, 폴더, 콘텐츠)를 가진 서비스에서 페이지 이동 시 이전 탐색 상태가 초기화되는 UX 저하 문제.
- **벤치마킹**: 
  - **구글 캘린더**: 날짜 이동 시 히스토리를 효율적으로 관리하는 방식.
  - **네이버/구글 메일**: 좌측 사이드바와 우측 콘텐츠의 중첩 라우팅 구조.
  - **이커머스**: 탭 전환 및 필터링 시 URL 기반의 상태 보존 방식.

---

## 📍 상세 라우팅 명세 (Routing Map)

### 1. 기본 및 인증 (Auth & Basics)
| 기능 | 경로 (Path) | 비고 |
| :--- | :--- | :--- |
| 비회원 랜딩 페이지 | `/` | |
| 로그인 | `/login` | |
| 회원가입 | `/signup` | |
| 메인 홈페이지 | `/home` | |
| 자료 업로드 | `/upload` | |
| 업로드 단계 이동 | `/{stepNumber}` | `replace` 처리 (단계별 히스토리 방지) |

### 2. 라이브러리 (Library) - 네이버 메일 방식
> 사이드바(폴더)와 콘텐츠 영역의 상태를 URL 계층으로 관리합니다.

- **기업 라이브러리 탭**: `/library/company`
  - 기업 폴더 선택: `/library/company/{companyName}`
  - 자기소개서 선택: `/library/company/{companyName}/{coverLetterId}`
- **문항 라이브러리 탭**: `/library/qna`
  - 문항 유형 폴더 선택: `/library/qna/{qnAName}`
  - 개별 문항 콘텐츠: `/library/qna/{qnAName}/{qnAId}`
- **공통 기능**:
  - 검색 결과: `?search={keyword}`
  - 페이지네이션: `?page={number}`

### 3. 자기소개서 작성 (Editor) - 복합 상태 관리
- **작성 리스트**: `/cover-letter/list`
- **신규 등록**: `/cover-letter/new`
- **에디터 화면**: `/cover-letter/edit/{coverLetterId}`
  - 문항 스크랩 모드: `&scrap&{qnAId}` (ID 기반 replace 처리로 중복 히스토리 방지)
  - 특정 문항 참조: `&{qnAId}`
- **협업(친구와 함께 첨삭)**: `/cover-letter/qna-friends/{coverLetterId}`

### 4. 나의 채용공고 (Recruit Calendar) - 구글 캘린더 방식
> 날짜 및 기간 이동 시 히스토리를 보존하되, 불필요한 스택은 `replace`로 최적화합니다.

- **초기 진입**: `/{YYYY}/{MM}/{DD}` (오늘 날짜)
- **날짜 클릭**: `/{YYYY}/{MM}/{DD}`
- **월 단위 이동**: `/{YYYY}/{MM}`

---

## ⚙️ 설계 전략 및 동작 방식

1. **계층적 경로(Nested Routing)**
   - 네이버 메일의 `folder/{id}` → `read/{mailId}` 구조를 차용하여, 좌측 리스트와 우측 상세 내용을 독립적인 URL Depth로 분리했습니다.
   - 이를 통해 특정 문항을 보다가 새로고침해도 해당 폴더의 위치와 문항 내용이 그대로 유지됩니다.

2. **히스토리 최적화 (Push vs Replace)**
   - 단순 탭 전환이나 업로드 단계 이동, 에디터 내의 상태 변경은 브라우저의 '뒤로 가기'를 과도하게 점유하지 않도록 `replace`를 활용했습니다.
   - 유의미한 페이지 전환(예: 다른 기업 폴더로 이동)에만 `push`를 사용하여 사용자에게 직관적인 히스토리를 제공합니다.

3. **URL 기반 검색 및 필터링**
   - 검색어(`search`)와 페이지 번호(`page`)를 Query String으로 관리하여 검색 결과 페이지를 타인에게 공유하거나 북마크할 수 있도록 설계했습니다.

---

## 👍 장점
- **UX 일관성**: '뒤로 가기' 버튼이 사용자의 기대대로 동작합니다.
- **공유 및 북마크**: 특정 날짜의 채용 일정이나 특정 폴더 내의 문항 리스트를 URL만으로 즉시 공유 가능합니다.
- **데이터 페칭 효율**: URL 파라미터를 API 호출의 Key로 활용하여, 상태 동기화 로직을 단순화(Single Source of Truth)했습니다.

## 👎 단점
- **URL 복잡도**: 중첩된 파라미터가 많아질 경우 URL이 길어질 수 있어 적절한 파싱 로직이 필요합니다.

---

## 🧩 사용 가이드
- **사용하기 좋은 상황**: 대시보드형 서비스, 중첩 폴더 구조의 라이브러리, 필터링이 중요한 리스트 페이지.
- **피해야 할 상황**: 보안상 URL에 ID나 상태가 노출되지 않아야 하는 민감한 정보 처리 시.